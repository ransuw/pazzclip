(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[507],{51:e=>{e.exports={main:"ReceiptEditor_main__1ocgu"}},208:(e,t,a)=>{"use strict";a.d(t,{Y:()=>o});var r=a(7876),n=a(8230),s=a.n(n),l=a(8907),c=a.n(l),i=a(9099);let o=()=>{let{basePath:e}=(0,i.useRouter)();return(0,r.jsxs)("div",{className:c().header,children:[(0,r.jsx)(s(),{href:"/",className:c().mainIcon,children:(0,r.jsx)("img",{src:"".concat(e,"/pazzclip.webp"),alt:"アイコン"})}),(0,r.jsx)(s(),{href:"/character",className:c().headerIcon,children:"切り抜き"}),(0,r.jsx)(s(),{href:"/party",className:c().headerIcon,children:"チーム設定"}),(0,r.jsx)(s(),{href:"/steps2play",className:c().headerIcon,children:"攻略手順"}),(0,r.jsx)(s(),{href:"/rules",className:c().headerIcon,children:"利用規約"}),(0,r.jsx)(s(),{href:"/privacy",className:c().headerIcon,children:"プライバシーポリシー"}),(0,r.jsxs)("div",{className:c().copyright,children:[(0,r.jsx)("div",{children:(0,r.jsx)(s(),{href:"https://www.gungho.jp/",target:"_blank",style:{color:"#0070f3",textDecoration:"underline"},children:"\xa9 GungHo Online Entertainment Inc. All Right Reserved."})}),(0,r.jsx)("div",{children:(0,r.jsx)(s(),{href:"https://www.gungho.jp/manner/copyright.html",target:"_blank",style:{color:"#0070f3",textDecoration:"underline"},children:"※当サイト上で使用を想定するゲーム画像の著作権および商標権、その他知的財産権は、当該コンテンツの提供元に帰属します。"})})]})]})}},4453:e=>{e.exports={main:"TransformList_main__aBLGg",saveBox:"TransformList_saveBox__dpF9_",saveIcon:"TransformList_saveIcon__mfbqh",iconBlock:"TransformList_iconBlock__CWsmf",text:"TransformList_text__zN0Hw",arrow:"TransformList_arrow__itHYL",icon:"TransformList_icon__YAjV3",buttonUpload:"TransformList_buttonUpload__MD80o",buttonReset:"TransformList_buttonReset__ybntc"}},5372:(e,t,a)=>{"use strict";a.r(t),a.d(t,{__N_SSG:()=>k,default:()=>N});var r=a(7876),n=a(4232),s=a(4453),l=a.n(s),c=a(6670);let i=e=>{let{emojiMap:t,setEmojiMap:a,setCopiedEmoji:s}=e,[i,o]=(0,n.useState)(""),u=(0,n.useRef)(null),[d,h]=(0,n.useState)(""),m=(0,n.useCallback)(e=>{e.preventDefault();try{let t=e.dataTransfer.files[0];if(t&&t.type.startsWith("image/")){let e=new FileReader;e.onload=()=>{let t=e.result;t&&o(t)},e.readAsDataURL(t)}}catch(e){console.log(e)}},[]),p=(0,n.useCallback)(()=>{(async()=>{a(Object.fromEntries((await (0,c.pi)()).map(e=>{let{key:t,image:a}=e;return[t,a]})))})()},[a]),g=(0,n.useCallback)(async()=>{try{if(d&&i){if(/^\d{1,100}'$/.test(d))return void alert("登録が禁止されている文字が含まれます。");await (0,c.hy)(d)?alert("すでに絵文字が登録されています。別の絵文字を使用してください。"):((0,c.k)(d,i),h(""),o(""),p())}else alert("絵文字を一つまたは画像を挿入してください")}catch(e){console.log(e)}},[d,i,p]);(0,n.useEffect)(()=>{p()},[p]);let _=(0,n.useCallback)(e=>{h(e.target.value)},[]),x=(0,n.useCallback)(async()=>{try{if(!window.confirm("画像をすべて削除しますか？ただし'切り抜き'で保存したアイコン情報は削除されません。"))return;await (0,c.LF)()?p():alert("DB上の画像の削除に失敗しました")}catch(e){console.error(e)}},[p]),j=(0,n.useCallback)(e=>{e.preventDefault();try{var t;let a=null==(t=e.target.files)?void 0:t[0];if(a&&a.type.startsWith("image/")){let e=new FileReader;e.onload=()=>{let t=e.result;t&&o(t)},e.readAsDataURL(a)}}catch(e){console.log(e)}},[]);return(0,r.jsxs)("div",{className:l().main,children:[(0,r.jsxs)("div",{className:l().saveBox,children:[(0,r.jsx)("button",{onClick:()=>x(),className:l().buttonReset,children:"画像削除"}),(0,r.jsxs)("div",{className:l().saveIcon,onDragOver:e=>e.preventDefault(),onDrop:m,onClick:()=>{var e;return null==(e=u.current)?void 0:e.click()},style:{backgroundColor:i?"transparent":"black"},children:[(0,r.jsx)("input",{type:"file",accept:"image/*",ref:u,style:{display:"none"},onChange:j}),i&&(0,r.jsx)("img",{src:i,alt:"アイコン"})]}),(0,r.jsx)("input",{type:"text",placeholder:"絵文字を1つ入力",value:d||"",onChange:e=>{_(e)}}),(0,r.jsx)("button",{className:l().buttonUpload,onClick:g,children:"更新"})]}),Object.entries(t).map(e=>{let[t,a]=e;return(0,r.jsxs)("div",{className:l().iconBlock,children:[(0,r.jsx)("div",{className:l().text,children:t}),(0,r.jsx)("div",{className:l().arrow,children:"→"}),(0,r.jsx)("img",{src:a,alt:"画像",className:l().icon,draggable:!0,onDragStart:e=>{e.dataTransfer.setData("text/plain",t)},onDoubleClick:()=>s(t)})]},t)})]})};var o=a(51),u=a.n(o);let d=e=>{let{text:t,setText:a,copiedEmoji:s,setCopiedEmoji:l}=e,c=(0,n.useRef)(!0);(0,n.useEffect)(()=>{if(c.current){c.current=!1;return}localStorage.setItem("receiptText",t)},[t]),(0,n.useEffect)(()=>{try{let e=localStorage.getItem("receiptText");e&&a(e)}catch(e){console.error("useEffect[]でエラー",e)}},[a]);let i=(0,n.useCallback)(e=>{let t=o.current;if(!t)return;let r=t.selectionStart,n=t.selectionEnd;a(t=>t.slice(0,r)+e+t.slice(n)),setTimeout(()=>{t.selectionStart=t.selectionEnd=r+e.length,t.focus()},0)},[a]);(0,n.useEffect)(()=>{s&&(i(s),l(""))},[s,l,i]);let o=(0,n.useRef)(null);return(0,r.jsx)("div",{className:u().main,children:(0,r.jsx)("textarea",{value:t,ref:o,onChange:e=>{a(e.target.value)},onDrop:async e=>{e.preventDefault(),i(e.dataTransfer.getData("text/plain"))},onDragOver:e=>e.preventDefault()})})};var h=a(8895),m=a.n(h),p=a(3028),g=a.n(p),_=a(8847);let x=a.n(_)()(()=>a.e(852).then(a.bind(a,4852)),{loadableGenerated:{webpack:()=>[4852]},ssr:!1}),j=e=>{let{mainText:t,emojiMap:a}=e,s="rgba(255, 255, 255, 1)",[l,c]=(0,n.useState)(s),[i,o]=(0,n.useState)(16),[u,d]=(0,n.useState)(360),[h,p]=(0,n.useState)(13),_="left",[j,v]=(0,n.useState)(_),b=(0,n.useRef)(null),y=(0,n.useCallback)(()=>{b.current&&g()(b.current,{backgroundColor:null}).then(e=>{let t=document.createElement("a");t.href=e.toDataURL("image/png"),t.download="レシート.png",t.click()})},[]),f=(0,n.useCallback)(()=>{c(s),o(16),d(360),p(13),v(_)},[]),w=(0,n.useCallback)(e=>{o(Number(e.target.value))},[]),k=(0,n.useCallback)(e=>{d(Number(e.target.value))},[]),N=(0,n.useCallback)(e=>{p(Number(e.target.value))},[]);return(0,r.jsxs)("div",{className:m().main,style:{width:u+15},children:[(0,r.jsxs)("div",{className:m().buttons,children:[(0,r.jsx)("button",{onClick:()=>y(),className:m().buttonDownload,children:"ダウンロード"}),(0,r.jsx)("button",{onClick:()=>f(),className:m().buttonReset,children:"リセット"})]}),(0,r.jsx)("div",{ref:b,children:(0,r.jsx)("div",{className:m().textForm,style:{background:l,fontSize:h,width:u,textAlign:j},children:(e=>{let t=Object.keys(a).sort((e,t)=>t.length-e.length),n=[],s=0,l="";for(;s<e.length;){let c=!1;for(let o of t)if(e.startsWith(o,s)){l&&(n.push(l),l=""),n.push((0,r.jsx)("img",{src:a[o],alt:o,height:i,style:{verticalAlign:"middle",marginBottom:2,marginLeft:1}},n.length)),s+=o.length,c=!0;break}if(!c){let t=e[s];"\n"===t?(l&&(n.push(l),l=""),n.push((0,r.jsx)("br",{},n.length))):l+=t,s+=1}}return l&&n.push(l),n})(t)})}),(0,r.jsxs)("div",{className:m().input_row,children:[(0,r.jsxs)("div",{className:m().input_contains,children:[(0,r.jsx)("div",{children:"文字："}),(0,r.jsx)("input",{type:"number",value:h||"",min:1,max:100,onChange:e=>{N(e)}})]}),(0,r.jsxs)("div",{className:m().input_contains,children:[(0,r.jsx)("div",{children:"画像："}),(0,r.jsx)("input",{type:"number",value:i||"",min:1,max:100,onChange:e=>{w(e)}})]}),(0,r.jsxs)("div",{className:m().input_contains,children:[(0,r.jsx)("div",{children:"横幅："}),(0,r.jsx)("input",{type:"number",value:u||"",min:20,max:800,onChange:e=>{k(e)}})]})]}),(0,r.jsxs)("select",{onChange:e=>v(e.target.value),className:m().tabSelect,value:j,children:[(0,r.jsx)("option",{value:"left",children:"左揃え"}),(0,r.jsx)("option",{value:"center",children:"中央揃え"}),(0,r.jsx)("option",{value:"right",children:"右揃え"})]}),(0,r.jsx)(x,{color:l,onChange:e=>{c("rgba(".concat(e.rgb.r,", ").concat(e.rgb.g,", ").concat(e.rgb.b,", ").concat(e.rgb.a,")"))}})]})};var v=a(6981),b=a.n(v);let y=()=>{let[e,t]=(0,n.useState)(""),[a,s]=(0,n.useState)({}),[l,c]=(0,n.useState)("");return(0,r.jsxs)("div",{className:b().main,children:[(0,r.jsx)(i,{emojiMap:a,setEmojiMap:s,setCopiedEmoji:c}),(0,r.jsx)(d,{text:e,setText:t,copiedEmoji:l,setCopiedEmoji:c}),(0,r.jsx)(j,{mainText:e,emojiMap:a})]})};var f=a(208),w=a(3916),k=!0;function N(){return(0,r.jsxs)("div",{style:{height:"100vh",display:"flex",flexDirection:"column",overflow:"auto"},children:[(0,r.jsx)(f.Y,{}),(0,r.jsx)(w.P.div,{initial:{x:300,opacity:0},animate:{x:0,opacity:1},exit:{x:-300,opacity:0},transition:{duration:.5},style:{flex:1,overflowY:"auto"},children:(0,r.jsx)(y,{})})]})}},6670:(e,t,a)=>{"use strict";a.d(t,{LF:()=>v,OS:()=>d,V8:()=>g,hy:()=>j,k:()=>_,lP:()=>h,pB:()=>u,pi:()=>x,ss:()=>m,vD:()=>p,vt:()=>o});var r=a(9523);let n="characterImages",s="arousalImages",l="iconImages",c=async()=>(0,r.P2)("CharacterDB",1,{upgrade(e){e.objectStoreNames.contains(n)||e.createObjectStore(n,{keyPath:"id",autoIncrement:!0}),e.objectStoreNames.contains(s)||e.createObjectStore(s,{keyPath:"id",autoIncrement:!1}),e.objectStoreNames.contains(l)||e.createObjectStore(l,{keyPath:"id",autoIncrement:!0})}}),i=async e=>{try{let t=(await c()).transaction(e,"readwrite");return await t.objectStore(e).clear(),await t.done,!0}catch(e){return console.error("clearImages 失敗:",e),!1}},o=async(e,t,a,r)=>{try{let s=await c();await s.add(n,{characterIcon:e,arousal10:t,potential:a,leader:r})}catch(e){console.log("saveCharacterImages",e)}},u=async()=>{let e=(await c()).transaction(n,"readonly").objectStore(n);return(await e.getAll()).reverse().map(e=>{let{id:t,characterIcon:a}=e;return{id:t,characterIcon:a}})},d=async e=>{let t=await c();return await t.get(n,e)},h=async()=>{try{return i(n)}catch(e){return console.error("clearCharacterImages 失敗:",e),!1}},m=async(e,t)=>{try{let a=await c();await a.put(s,{id:e,image:t})}catch(e){console.log("saveArousalImage",e)}},p=async e=>{let t=await c();return await t.get(s,e)},g=async()=>{try{return i(s)}catch(e){return console.error("clearImages 失敗:",e),!1}},_=async(e,t)=>{try{let a=await c();await a.add(l,{key:e,image:t})}catch(e){console.log("saveIconImage",e)}},x=async()=>{let e=await c(),t=e.transaction(l,"readonly").objectStore(l),a=await t.getAll(),r=e.transaction(n,"readonly").objectStore(n),s=await r.getAll();return[...a.map(e=>{let{key:t,image:a}=e;return{type:"icon",key:t,image:a}}),...s.map(e=>{let{id:t,characterIcon:a}=e;return{type:"character",key:t+"'",image:a}})]},j=async e=>{try{let t=await c(),a=t.transaction(l,"readonly").objectStore(l),r=await a.getAll(),s=t.transaction(n,"readonly").objectStore(n),i=await s.getAll();return[...r.map(e=>{let{key:t,image:a}=e;return{type:"icon",key:t,image:a}}),...i.map(e=>{let{id:t,characterIcon:a}=e;return{type:"character",key:t+"'",image:a}})].some(t=>t.key===e)}catch(e){return console.error("checkIconKey 失敗:",e),!1}},v=async()=>{try{return i(l)}catch(e){return console.error("clearImages 失敗:",e),!1}}},6981:e=>{e.exports={main:"ReceiptTab_main__92HD3"}},8350:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/steps2play",function(){return a(5372)}])},8895:e=>{e.exports={main:"ReceiptHTML_main__AzTdw",buttons:"ReceiptHTML_buttons__aVFMN",input_row:"ReceiptHTML_input_row__HvHiD",input_contains:"ReceiptHTML_input_contains__w7h0c",textForm:"ReceiptHTML_textForm__r3Y4H",buttonDownload:"ReceiptHTML_buttonDownload__OGvkU",buttonReset:"ReceiptHTML_buttonReset__ziXZU",tabSelect:"ReceiptHTML_tabSelect__B3d3D"}},8907:e=>{e.exports={main:"Header_main__ck7TP",header:"Header_header__072v2",mainIcon:"Header_mainIcon__No0Lm",headerIcon:"Header_headerIcon__N5vzn",copyright:"Header_copyright__oIrOL"}}},e=>{var t=t=>e(e.s=t);e.O(0,[366,389,805,636,593,792],()=>t(8350)),_N_E=e.O()}]);